.. _examples:

Example projects and data-sets
==============================

The PALEOMIX pipeline contains small example projects for the larger pipelines, which are designed to be executed in a short amount of time, and to help verify that the pipelines have been correctly installed.


The BAM Pipeline
----------------

The example project for the BAM pipeline involves the processing of a small data set consisting of (simulated) ancient sequences derived from the human mitochondrial genome. The runtime of this project on a typical desktop or laptop ranges from around 1 minute to around 1 hour (when building of models of the ancient DNA damage patterns is enabled). To access this example project, use the 'example' command for the bam\_pipeline to copy the project files to a given directory (here, the current directory)::

    $ paleomix bam_pipeline example .
    $ cd bam_pipeline
    $ paleomix bam_pipeline run 000_makefile.yaml

By default, this example project includes the recalibration of quality scores for bases that are identified as putative *post-mortem* damage (see [Jonsson2013]_). However, this greatly increases the time needed to run this example. While it is recommended to run this step, this step may be disabled by setting the value of the 'RescaleQualities' option in the '000\_makefile.yaml' file to 'no'.

Before:

.. code-block:: yaml
    :emphasize-lines: 3
    :linenos:
    :lineno-start: 83

    # Carry out quality base re-scaling of libraries using mapDamage
    # This will be done using the options set for mapDamage below
    RescaleQualities: yes

After:

.. code-block:: yaml
    :emphasize-lines: 3
    :linenos:
    :lineno-start: 83

    # Carry out quality base re-scaling of libraries using mapDamage
    # This will be done using the options set for mapDamage below
    RescaleQualities: no

The output generated by the pipeline is described in the :ref:`bam_filestructure` section. Please see the :ref:`troubleshooting` section if you run into problems running the pipeline.


The Phylogentic Pipeline
------------------------

The example project for the Phylogenetic pipeline involves the processing and mapping of a small data set consisting of (simulated) sequences derived from the human and primate mitochondrial genome, followed by the genotyping of gene sequences and the construction of a maximum likelihood phylogeny. Since this example project starts from raw reads, it therefore requires that the BAM pipeline has been correctly installed, as described in section :ref:`bam_requirements`). The runtime of this project on a typical desktop or laptop ranges from around 30 minutes to around 1 hour.

To access this example project, use the 'example' command for the phylo\_pipeline to copy the project files to a given directory (here, the current directory), and then run the 'setup.sh' script in the root folder, to generate the data set::

    $ paleomix phylo_pipeline example .
    $ cd phylo_pipeline
    $ ./setup.sh

Once the example data has been generated, the two pipelines may be executed::

    $ cd alignment
    $ bam_pipeline run 000_makefile.yaml
    $ cd ../phylogeny
    $ phylo_pipeline genotype+msa+phylogeny 000_makefile.yaml

The output generated by the pipeline is described in the :ref:`phylo_filestructure` section. Please see the :ref:`troubleshooting` section if you run into problems running the pipeline.
